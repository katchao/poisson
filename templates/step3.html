
	<h1>Poisson Composite Image Creator</h1>

	<p><strong>Step 3:</strong> Upload your target image.</p>

    <form id="targetform" enctype="multipart/form-data">
    	<label for="name">Target file:</label> <input type="file" id="target" name="target" />

		<input type="submit" id="submit" value="Submit" disabled>
	</form>

	<div id="targetpreview"></div><br />


	<script>
		$(function() {
		var reader = new FileReader();

		$("#target").change(function(){
			if (this.files && this.files[0]) {
				var valid = validate(this.files[0]);

				if(valid) {
					reader.onload = function (e) {
						$("#targetpreview").html("<img src=" + e.target.result + " />");
					}
					reader.readAsDataURL(this.files[0]);
					$("#submit").prop("disabled", false);
				}
			}
			
		});

		$("#targetform").submit(function(e) {
			// stop form from submitting normally
			e.preventDefault();

			var formData = new FormData($('#targetform')[0]);

    		// process the form
    		$.ajax({
        		type: 'POST',
        		url: '/submit_target',
        		data: formData,

        		contentType: false,
        		dataType : false,
                processData: false
    		})
    		.done(function(data) {
    			$('#main-content').html(data);
    		});

		});

	});
	</script>